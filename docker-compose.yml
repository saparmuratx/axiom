services:
  auth:
    build:
      context: ./auth
      dockerfile: Dockerfile
    ports:
      - "127.0.0.1:8000:8000"
    env_file:
      - ./auth/.env
    
  auth-db:
    image: postgres:18
    container_name: auth-db
    env_file:
    - ./auth/.env.postgres
    volumes:
      - auth-db-data:/var/lib/postgresql/data
    ports:
      - "127.0.0.1:5432:5432"

  library:
    build:
      context: ./library
      dockerfile: Dockerfile
    ports:
      - "127.0.0.1:8001:8000"
    env_file:
      - ./library/.env
    
  library-db:
    image: postgres:18
    container_name: library-db
    env_file:
      - ./library/.env.postgres
    volumes:
      - library-db-data:/var/lib/postgresql/data
    ports:
      - "127.0.0.1:5433:5433"    
    command: ["postgres", "-c", "port=5433"]


volumes:
  auth-db-data:
  library-db-data:
